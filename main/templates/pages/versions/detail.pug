extends base.html

block style
   style.
            /* General modal styles */
      .modal-bkgd {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 100;
      padding: 20px;
      }

      .modal-bkgd:not(.hidden) {
      display: flex;
      justify-content: center;
      align-items: center;
      }

      .modal-body {
      background-color: #4444;
      border-radius: 5px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      max-width: 500px;
      padding: 20px;
      }

      .modal-head {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
      }

      .modal-details {
      font-size: 16px;
      line-height: 1.5;
      }




block content

   a(href="../") Back to Versions

   div
      #ellipsis-menu.float-right
         button.p-1.rounded-full(
            class="hover:bg-gray-200" 
            _="on click toggle .hidden on #ellipsis-dd end")

            i.fas.fa-ellipsis-h.text-gray-500

            #ellipsis-dd.absoluteleft-0.mt-2.w-48.bg-white.rounded-md.shadow-lg.z-10.hidden
               a.flex.flex-row(href='delete/')
                  i.fa-trash.fa-duotone
                  span.px-4.py-2.text-gray-800(class="hover:text-gray-500") Delete
         


      if version.status == "DFT"
         div.text-xs.bg-amber-200.text-amber-700.font-bold.rounded-sm.shadow.w-fc.px-2 DRAFT
      h1.text-2xl Version #{version.name}
      h2.text-xl  Schedule #{version.schedule}

      if version.percent < 80
         div.p-3.rounded.w-fc.shadow.bg-red-700 #{version.percent}% completed
      else
         if version.percent < 98
            div.p-3.rounded.w-fc.shadow.bg-yellow-500 #{version.percent}% completed 
         else
            div.p-3.rounded.w-fc.shadow.bg-green-500 #{version.percent}% completed

      if version.status == "DFT"
         div(class="container my-2 py-5 bg-zinc-900 bg-opacity-60 rounded")
            div(class="flex justify-center")
            div(class="flex space-x-2")
               button(class="px-4 py-2 bg-blue-500 text-white font-semibold rounded-md hover:bg-blue-700"
                   _="on click fetch solve/ then put result into .result")
                  | Solve
               button(class="px-4 py-2 bg-sky-500 text-white font-semibold rounded-md hover:bg-sky-700"
                  _="on click log 'clearing' then fetch clear/ then put result into .result")
                  | Clear
               button(class="px-4 py-2 bg-indigo-500 text-white font-semibold rounded-md hover:bg-indigo-700")
                  |  Analyze

            .result
      

   table
      each wd in version.workdays.all
         tr
            th #{wd.date}
            each slot in wd.slots.all
               if slot.employee != None
                  td.bg-green-700.rounded-sm.px-2 
                     div.slot(
                        _="on click fetch #{slot.url} then put result into .modal-details then remove .hidden from #slot-modal"
                        class="bg-transparent"
                        data-empl="#{slot.employee.name}"
                        data-tooltip="tooltip-dark-#{slot.pk}"
                        ) #{slot.shift.name}
                     .text-zinc-300(id="tooltip-dark-#{slot.pk}")
                        | #{slot.employee.name}
               else
                  td.bg-gray-500.rounded-sm.px-2
                     if slot.fills_with.count == 0
                        div(
                           _="on click fetch #{slot.url} then put result into .modal-details then remove .hidden from #slot-modal"
                           class="bg-red-500 text-red-100") #{slot.shift.name}
                     else
                        div(
                           _="on click fetch #{slot.url} then put result into .modal-details then remove .hidden from #slot-modal"
                           class="bg-transparent") #{slot.shift.name}

   div.rounded.bg-zinc-100.bg-opacity-10.p-3.overflow-x-scroll.overscroll-auto
   
      table
         each empl in version.schedule.department.employees.all
            tr 
               th #{empl.name}
               each wd in version.workdays.all
                  if wd.weekday == 'Saturday'
                     td.border-r
                        each slot in wd.slots.all
                           if slot.employee == empl
                              a(href=slot.url class="bg-transparent") #{slot.shift.name}
                          
                  else    
                     td
                        each slot in wd.slots.all
                           if slot.employee == empl
                              a(href=slot.url class="bg-transparent") #{slot.shift.name}
                           
                          
   #slot-modal.modal-bkgd.hidden(
      _="on click call event.stopImmediatePropagation() then add .hidden")
      .modal-body 
         .modal-head Slot
         .modal-details



